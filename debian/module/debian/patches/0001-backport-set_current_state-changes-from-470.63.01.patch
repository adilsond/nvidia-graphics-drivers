From 44b3b870a66d0d06627946a55437dbf7388b6783 Mon Sep 17 00:00:00 2001
From: Andreas Beckmann <anbe@debian.org>
Date: Sun, 19 Sep 2021 15:24:53 +0200
Subject: [PATCH] backport set_current_state changes from 470.63.01

---
 os-interface.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/os-interface.c b/os-interface.c
index e170c7c..640e89f 100644
--- a/os-interface.c
+++ b/os-interface.c
@@ -549,7 +549,7 @@ RM_STATUS NV_API_CALL os_delay(NvU32 MilliSeconds)
         // the requested timeout has expired, loop until less
         // than a jiffie of the desired delay remains.
         //
-        current->state = TASK_INTERRUPTIBLE;
+        set_current_state(TASK_INTERRUPTIBLE);
         do
         {
             schedule_timeout(jiffies);
-- 
2.20.1

